Доброго времени суток товарищи!

К сожалению не успел целиком выполнить все пукнты
Выполнял на Laravel т.к. на этом фреймворке быстрее всего в моем случае начать
Yii видел только издалека)


Хотел тут объясниться как планировал реализовывать

- Аутентификация стандартная Laravel
- Денежный приз реализован за исключением конвертации в бонусные баллы(видится несложная функция для рассчета кол-ва баллов согласно коэфициента)
- Созданы обертки для бонусных баллов и физического приза
По бонусным баллам достаточно простая реализация с сохранением истории изменения баланса у пользователей в базе + логи
Касательно физ. приза - рандомный выбор на основании существующих в БД элементов и их количественного остатка.
- По всем типам выйгрышей шаги вижу следующие:


*  Первый реквест - рандомно решаем какой тип лотереи попал пользователю. На основании этого приложение выбирает соответсвующий сервис-обработчик
Далее - проверяем доступность призов в БД, если достаточно - снова же рандомно выбираем кол-во/элемент, пишем в транзакции в историю выйгрышей, редьюсим остаток призов в БД
* Отдаем пользователю респонс о типе и кол-ве выйгрыша
* Для случая с денежным призом при выборе опции "Перечислить на банковский счет" - изменяем в БД значение "transfet_to_bank" на 1. Тут вижу реализацию Observer, который оповестит воркер о том, что нужно сложить в таблицу задач выйгрыши с этим флагом 
В последствии при запуске консольной комманды создаем очередь и дергаем таски(пачкой по 5), процессим в фоне отправку денег на банковские аккаунты юзеров.
* Для случя с отказом от физического приза - держал бы 2 таблицы: физическогое наличие товара(его кол-во), выйгранные товары. В момент игры сверял бы значения, вычислял остаток. Возвращать кол-во товара после отказа, путем апдейта этого кол-ва в основной таблице товара - не очень решение, т.к. увеличим кол-во блокирующих операций

Еще раз прошу прощения, что не успел в полном объеме все выполнить, готов ответить на любые вопросы